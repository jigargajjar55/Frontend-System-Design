const posts = [{
    fullText: "Hello this is just some random post created to show an example mock    post for this coding challenge",
    dateTimeCreated: "2020-07-20T18:44:11Z",
    dateTimeLastModified: "2020-07-20T18:44:11Z",
    type: "Post",
    from: {
      name: "Garima",
      email: "garima@gmail.com"
    }
  },{
    fullText: "Hello this is just some random post created to show an example mock post for this coding challenge. this needs to be completed in two hours.Hello this is just some random post created to show an example mock post for this coding challenge. this needs to be completed in two hoursHello this is just some random post created to show an example mock post for this coding challenge. this needs to be completed in two hoursHello this is just some random post created to show an example mock post for this coding challenge. this needs to be completed in two hoursHello this is just some random post created to show an example mock post for this coding challenge. this needs to be completed in two hoursHello this is just some random post created to show an example mock post for this coding challenge. this needs to be completed in two hoursHello this is just some random post created to show an example mock post for this coding challenge. this needs to be completed in two hoursHello this is just some random post created to show an example mock post for this coding challenge. this needs to be completed in two hoursHello this is just some random post created to show an example mock post for this coding challenge. this needs to be completed in two hoursHello this is just some random post created to show an example mock post for this coding challenge. this needs to be completed in two hoursHello this is just some random post created to show an example mock post for this coding challenge. this needs to be completed in two hours",
    dateTimeCreated: "2020-07-20T18:44:11Z",
    dateTimeLastModified: "2020-07-20T18:44:11Z",
    type: "Reply",
    from: {
      name: "Viniket",
      email: "garima@gmail.com"
    }
  },{
    fullText: "Hello this is just some random post created to show an example mock    post for this coding challenge",
    dateTimeCreated: "2020-07-20T18:44:11Z",
    dateTimeLastModified: "2020-07-20T18:44:11Z",
    type: "Reply",
    from: {
      name: "Bhushan",
      email: "garima@gmail.com"
    }
  },{
    fullText: "Hello this is just some random post created to show an example mock    post for this coding challenge",
    dateTimeCreated: "2020-07-20T18:44:11Z",
    dateTimeLastModified: "2020-07-20T18:44:11Z",
    type: "Post",
    from: {
      name: "Tanvi",
      email: "garima@gmail.com"
    }
  },{
    fullText: "Hello this is just some random post created to show an example mock    post for this coding challenge",
    dateTimeCreated: "2020-07-20T18:44:11Z",
    dateTimeLastModified: "2020-07-20T18:44:11Z",
    type: "Post",
    from: {
      name: "Rahul",
      email: "garima@gmail.com"
    }
  },{
    fullText: "Hello this is just some random post created to show an example mock    post for this coding challenge",
    dateTimeCreated: "2020-07-20T18:44:11Z",
    dateTimeLastModified: "2020-07-20T18:44:11Z",
    type: "Post",
    from: {
      name: "Deeksha",
      email: "garima@gmail.com"
    }
  },{
    fullText: "Hello this is just some random post created to show an example mock    post for this coding challenge",
    dateTimeCreated: "2020-07-20T18:44:11Z",
    dateTimeLastModified: "2020-07-20T18:44:11Z",
    type: "Post",
    from: {
      name: "Swati",
      email: "garima@gmail.com"
    }
  },{
    fullText: "Hello this is just some random post created to show an example mock    post for this coding challenge",
    dateTimeCreated: "2020-07-20T18:44:11Z",
    dateTimeLastModified: "2020-07-20T18:44:11Z",
    type: "Post",
    from: {
      name: "Ketki",
      email: "garima@gmail.com"
    }
  },{
    fullText: "Hello this is just some random post created to show an example mock    post for this coding challenge",
    dateTimeCreated: "2020-07-20T18:44:11Z",
    dateTimeLastModified: "2020-07-20T18:44:11Z",
    type: "Post",
    from: {
      name: "Preksha",
      email: "garima@gmail.com"
    }
  },{
    fullText: "Hello this is just some random post created to show an example mock    post for this coding challenge",
    dateTimeCreated: "2020-07-20T18:44:11Z",
    dateTimeLastModified: "2020-07-20T18:44:11Z",
    type: "Post",
    from: {
      name: "Sonali",
      email: "garima@gmail.com"
    }
  },{
    fullText: "Hello this is just some random post created to show an example mock    post for this coding challenge",
    dateTimeCreated: "2020-07-20T18:44:11Z",
    dateTimeLastModified: "2020-07-20T18:44:11Z",
    type: "Post",
    from: {
      name: "Gagan",
      email: "garima@gmail.com"
    }
  },{
    fullText: "Hello this is just some random post created to show an example mock    post for this coding challenge",
    dateTimeCreated: "2020-07-20T18:44:11Z",
    dateTimeLastModified: "2020-07-20T18:44:11Z",
    type: "Post",
    from: {
      name: "Pratiksha",
      email: "garima@gmail.com"
    }
  },{
    fullText: "Hello this is just some random post created to show an example mock    post for this coding challenge",
    dateTimeCreated: "2020-07-20T18:44:11Z",
    dateTimeLastModified: "2020-07-20T18:44:11Z",
    type: "Reply",
    from: {
      name: "Bhagyashree",
      email: "garima@gmail.com"
    }
  },{
    fullText: "Hello this is just some random post created to show an example mock    post for this coding challenge",
    dateTimeCreated: "2020-07-20T18:44:11Z",
    dateTimeLastModified: "2020-07-20T18:44:11Z",
    type: "Post",
    from: {
      name: "Milind",
      email: "garima@gmail.com"
    }
  },{
    fullText: "Hello this is just some random post created to show an example mock    post for this coding challenge",
    dateTimeCreated: "2020-07-20T18:44:11Z",
    dateTimeLastModified: "2020-07-20T18:44:11Z",
    type: "Reply",
    from: {
      name: "Bhagyashree",
      email: "garima@gmail.com"
    }
  },{
    fullText: "Hello this is just some random post created to show an example mock    post for this coding challenge",
    dateTimeCreated: "2020-07-20T18:44:11Z",
    dateTimeLastModified: "2020-07-20T18:44:11Z",
    type: "Post",
    from: {
      name: "Milind",
      email: "garima@gmail.com"
    }
  }
];
  
  
  const paginationIndex = 5;
  let noOfPages = parseInt(posts.length/paginationIndex)+1;
  const paginationContainer = document.querySelector('.pagination-container');

  console.log(paginationContainer);
  for(let i =1;i<=noOfPages;i++){
    let button = document.createElement('button');
    button.classList.add('pagination-btn');
    if(i==1){
      button.classList.add('active');
    }
    button.id = i;
    button.innerText = i;
    paginationContainer.append(button);
  }
  const postsContainer = document.querySelector('#postsContainer');
  const paginationButtons = Array.from(document.querySelectorAll('.pagination-btn'));
  
  paginationButtons.forEach((button)=>{
    button.addEventListener('click', (e)=>{
      let currentActiveBtn = document.querySelector('.active');
      console.log('active', currentActiveBtn);
      currentActiveBtn.classList.remove('active');
      let clickedBtn = document.getElementById(e.target.id);
      console.log('new', clickedBtn);
      clickedBtn.classList.add('active');
      renderPosts(posts);
    });
  });
  
  // let filteredPosts = posts.filter((post)=>{
  //   return post.fullText.includes('he');
  // })
  // console.log(filteredPosts)
  
  const searchBox = document.querySelector('.searchBox');
  searchBox.addEventListener('keyup', (e)=>{
    let postSections = document.querySelectorAll('.post-section');
    for(let postSection of postSections){
      let postMessage = postSection.querySelector('.post-message');
      let text = postMessage.textContent;
      postMessage.remove();
      let textParts = text.toLowerCase().split(e.target.value.toLowerCase());
      console.log(textParts);
      let messageNode = document.createElement('p');
      messageNode.classList.add('post-message');
      textParts.forEach((part, index)=>{
        let span = document.createElement('span');
        let textNode = document.createTextNode(part);
        span.append(textNode);
         messageNode.append(span);
        if(index < textParts.length-1){
          let highLightedSpan = document.createElement('span');
        let highLightedTextNode =             document.createTextNode(e.target.value);
        highLightedSpan.classList.add('highlight');
        highLightedSpan.append(highLightedTextNode);
        messageNode.append(highLightedSpan);
        }
        
      });
      console.log(messageNode);
      postSection.append(messageNode);
    }
  })
  
  
  function renderPosts(posts){
    postsContainer.innerHTML='';
    let currentIndex = document.querySelector('.active').innerHTML;
    console.log('index',currentIndex)
    let start= (currentIndex-1)*paginationIndex;
    let end =  (currentIndex)*paginationIndex;
    if(end > posts.length){
      end = posts.length;
    }
    for(let i = start;i<end;i++){
      let post = posts[i];
      const postSection = document.createElement('section');
    postSection.classList.add('post-container');
    const nameNode = document.createElement('span');
    nameNode.classList.add('post-name')
    const NameText = document.createTextNode(post?.from?.name);
    nameNode.append(NameText);
    const typeNode = document.createElement('span');
    typeNode.classList.add('post-type')
    const typeText = document.createTextNode(post?.type?.toLowerCase() === 'post'? 'posted': 'replied');
    typeNode.append(typeText);
    const dateNode = document.createElement('span');
    dateNode.classList.add('post-date')
    const dateText = document.createTextNode(new Date(post.dateTimeCreated).toLocaleTimeString());
    dateNode.append(dateText);
     const messageNode = document.createElement('p');
    messageNode.classList.add('post-message')
    const messageText = document.createTextNode(post.fullText.length>500?post.fullText.slice(0, 497)+'...': post.fullText);
    messageNode.append(messageText);
    postSection.classList.add('post-section');
    postSection.append(nameNode);
    postSection.append(typeNode);
    postSection.append(dateNode);
    postSection.append(messageNode);
    postsContainer.append(postSection);
    }
  }
  
  renderPosts(posts);
  
  